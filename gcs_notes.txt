Remaining statics:
mchar global codesets
parse global rules
prefs global key file
findsep::output
ripstream::ripstream_rip_ogg
utf8 global current_charset

-----------------------------------------------------------------------
cygwin version
-----------------------------------------------------------------------

libiconv

./configure --prefix=/usr/local/mingw      CPPFLAGS="-mno-cygwin -mms-bitfields -Wall -I/usr/local/mingw/include"      CFLAGS="-mno-cygwin -mms-bitfields -O2 -g"      CXXFLAGS="-mno-cygwin -mms-bitfields -O2 -g"      LDFLAGS="-mno-cygwin -mms-bitfields -L/usr/local/mingw/lib" --enable-static

gettext.  Exact same flags.

Back to libiconv.  Not sure if this is actually necessary.  It didn't 
work to rerun configure on the existing directory, so I deleted and 
reran configure.

Tried to build glib, but apparently it requires pkg-config.  
pkg-config doesn't build:

if /bin/sh ./libtool --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I. -DG_LOG_DOMAIN=g_log_domain_glib   -mno-cygwin -Wall -I/usr/local/mingw/include  -mno-cygwin -mms-bitfields -O2 -g -Wall  -MT garray.lo -MD -MP -MF ".deps/garray.Tpo" \
          -c -o garray.lo `test -f 'garray.c' || echo './'`garray.c; \
        then mv -f ".deps/garray.Tpo" ".deps/garray.Plo"; \
        else rm -f ".deps/garray.Tpo"; exit 1; \
        fi
 gcc -DHAVE_CONFIG_H -I. -I. -I. -DG_LOG_DOMAIN=g_log_domain_glib -mno-cygwin -Wall -I/usr/local/mingw/include -mno-cygwin -mms-bitfields -O2 -g -Wall -MT garray.lo -MD -MP -MF .deps/garray.Tpo -c garray.c -o garray.o
In file included from garray.c:32:
glib.h:502: error: parse error before "gssize"
glib.h:502: warning: type defaults to `int' in declaration of `gssize'
glib.h:502: warning: data definition has no type or storage class
glib.h:503: error: parse error before "gsize"
glib.h:503: warning: type defaults to `int' in declaration of `gsize'
glib.h:503: warning: data definition has no type or storage class
glib.h:504: error: parse error before "GQuark"
glib.h:504: warning: type defaults to `int' in declaration of `GQuark'
glib.h:504: warning: data definition has no type or storage class

pkg-config doesn't build on mingw either, but the error is different.

1) ./configure works fine for cygwin without options
2) Try removing -mms-bitfields, still fails
3) Try removing -mnocygwin, works.  Hopefully -mno-cygwin isn't necessary, 
because glib only needs the exe.

./configure --prefix=/usr/local/mingw      CPPFLAGS="-Wall -I/usr/local/mingw/include"      CFLAGS="-mno-cygwin -mms-bitfields -O2 -g"      CXXFLAGS="-mno-cygwin -mms-bitfields -O2 -g"      LDFLAGS="-mno-cygwin -mms-bitfields -L/usr/local/mingw/lib" --enable-static

OK, now onto glib

checking size of __int64... 8
configure: error:
*** GLib requires a 64 bit type. You might want to consider
*** using the GNU C compiler.

Egad.

1) Try without -mms-bitfields, same error
2) Try plain ./configure, this fails because iconv isn't found
3) Try without -mms-bitfields and -mno-cygwin.

checking for ngettext in -lintl... no
configure: error:
*** You must have either have gettext support in your C library, or use the
*** GNU gettext library. (http://www.gnu.org/software/gettext/gettext.html

Here, this is failing presumably because it can't link without no-cygwin?
Undefined references to __errno, __flsbuf in libintl.

--
Trying again.

a) Slight refinement in config paths
b) Install cygwin version of pkg-config
c) Do the following before configuring glib, so that it can find gmsgtxt
    PATH=/usr/local/mingw/bin:$PATH

It seems the problem with 64 bit is that gcc -mno-cygwin (or another opt)? 
makes fopen(fn,"w") use DOS EOL's.  Just plain gcc doesn't do this.
So, the fix is to edit configure to change the "w"'s to "wb".

It configures.  Next error:

 gcc -DHAVE_CONFIG_H -I. -I. -I.. -I.. -DG_LOG_DOMAIN=\"GLib\" -DG_DISABLE_CAST_CHECKS -DG_DISABLE_DEPRECATED -DGLIB_COMPILATION -mno-cygwin -mms-bitfields -Wall -I/usr/local/mingw/include -mno-cygwin -mms-bitfields -O2 -g -Wall -MT gbacktrace.lo -MD -MP -MF .deps/gbacktrace.Tpo -c gbacktrace.c  -DDLL_EXPORT -DPIC -o .libs/gbacktrace.o
gbacktrace.c: In function `g_on_error_stack_trace':
gbacktrace.c:175: warning: implicit declaration of function `fork'
gbacktrace.c:187: warning: implicit declaration of function `waitpid'
gbacktrace.c: In function `stack_trace':
gbacktrace.c:220: error: `SIGCHLD' undeclared (first use in this function)
gbacktrace.c:220: error: (Each undeclared identifier is reported only once
gbacktrace.c:220: error: for each function it appears in.)
gbacktrace.c:222: warning: implicit declaration of function `pipe'
gbacktrace.c:235: warning: passing arg 2 of `execvp' from incompatible pointer type
gbacktrace.c:245: warning: implicit declaration of function `FD_ZERO'
gbacktrace.c:246: warning: implicit declaration of function `FD_SET'
gbacktrace.c:261: warning: implicit declaration of function `select'
gbacktrace.c:261: error: `FD_SETSIZE' undeclared (first use in this function)
gbacktrace.c:265: warning: implicit declaration of function `FD_ISSET'

So, I copied over the config.h & glibconfig.h.

Not bad, but still have errors.  I think it didn't actually 
configure correctly.  It should have picked up giowin32.c instead.

 gcc -DHAVE_CONFIG_H -I. -I. -I.. -I.. -DG_LOG_DOMAIN=\"GLib\" -DG_DISABLE_CAST_CHECKS -DG_DISABLE_DEPRECATED -DGLIB_COMPILATION -mno-cygwin -mms-bitfields -Wall -I/usr/local/mingw/include -mno-cygwin -mms-bitfields -O2 -g -Wall -MT giounix.lo -MD -MP -MF .deps/giounix.Tpo -c giounix.c  -DDLL_EXPORT -DPIC -o .libs/giounix.o
giounix.c: In function `g_io_unix_set_flags':
giounix.c:374: error: `O_NDELAY' undeclared (first use in this function)
giounix.c:374: error: (Each undeclared identifier is reported only once
giounix.c:374: error: for each function it appears in.)
giounix.c:377: warning: implicit declaration of function `fcntl'
giounix.c:377: error: `F_SETFL' undeclared (first use in this function)
giounix.c: In function `g_io_unix_get_flags':
giounix.c:395: error: `F_GETFL' undeclared (first use in this function)
giounix.c:409: error: `O_NDELAY' undeclared (first use in this function)
giounix.c: In function `g_io_channel_new_file_utf8':
giounix.c:511: error: `S_IRGRP' undeclared (first use in this function)
giounix.c:511: error: `S_IWGRP' undeclared (first use in this function)
giounix.c:511: error: `S_IROTH' undeclared (first use in this function)
giounix.c:511: error: `S_IWOTH' undeclared (first use in this function)

-----------------------------------------------------------------------
Docking code

dock_do_mousemove
  

-----------------------------------------------------------------------
Original plugin organization

Winamp winproc -> hook_winamp_callback
  WM_SHOWWINDOW (window being hidden)
    switch_docking_index()
    dock_window()
  WM_WINDOWPOSCHANGED
    dock_window()


-----------------------------------------------------------------------
* Multirip/main loop

Streamripper has 4 threads, and one child process.

main (GUI thread)
  ripthread (reads from server)
    thread_accept (waits for new relay connections)
    thread_send (writes to relay clients)
    External process (reads from stdin pipe)

Ripthread
  

Subsystem naming convention
  rip_manager_init()      // Static memory/once per process
    rip_manager_start()   //   Dynamic memory/once per stream
    rip_manager_stop()    //   Dynamic memory/once per stream
  rip_manager_cleanup()   // Static memory/once per process

Shutdown procedure
  signal handler sets m_got_sig on (CTL-C)
  callback sets m_alldone on ??
  gui thread polls m_got_sig and m_alldone
    call rip_manager_stop() if either flags are seen

Relay startup and shutdown
  rip_manager_start() calls relaylib_start()
  On reconnection, ripthread() calls relaylib_stop() and relaylib_start()



Data structs:
  1) Global preferences
  2) Stream preferences
  3) Stream state variables (rmi)

Semaphore/Mutex
  1) cbuf2->cbuf_sem
  2) m_debug_lock
  3) m_started_sem
  4) m_sem_not_connected
  5) g_relay_list_sem

-----------------------------------------------------------------------
HTTP HEADERS

http://141.211.232.136:8000/wcbn-lo.ogg
===============================

http://stream.orban.com:8006 (Shoutcast/aac)
===============================
ICY 200 OK
icy-notice1:<BR>This stream requires <a href="http://www.winamp.com/">Winamp</a>
<BR>
icy-notice2:SHOUTcast Distributed Network Audio Server/win32 v1.9.4<BR>
icy-name:Nap's Jazz and Smooth Jazz
icy-genre:Jazz
icy-url:http://www.orban.com
content-type:audio/aac
icy-pub:1
icy-metaint:8192
icy-br:32

http://inet.orban.com:8010/test.aac (icecast2/aac)
===============================
HTTP/1.0 200 OK
Content-Type: audio/mpeg
icy-metaint:16000
icy-br:32
icy-description:Hi-Fi Internet Audio
icy-genre:Various
icy-name:Orban Opticodec-PC Encoder - aacPlus v2 Evaluation Stream
icy-pub:1
icy-url:http://www.orban.com
Server: Icecast 2.1.0

http://stream2.noise.net.nz:8000/twisted-lofi.ogg (icecast2/ogg)
===============================
HTTP/1.0 200 OK
Content-Type: application/ogg
ice-audio-info: samplerate=22000
icy-description:More than just great dance music!
icy-genre:Dance
icy-name:Twisted 107.7FM
icy-pub:1
icy-url:http://www.twisted.co.nz
Server: Icecast 2.0-kh58

http://rstream.xmission.com:8000/krcl-low.ogg (icecast2/ogg)
===============================
HTTP/1.0 200 OK
Content-Type: application/ogg
icy-br:0
icy-genre:ecclectic
icy-name:KRCL Community Radio
icy-pub:1
icy-url:http://www.krcl.org
Server: Icecast 2.1.0

http://64.236.34.97/stream/1021
===============================
ICY 200 OK
icy-notice1: <BR>This stream requires <a href="http://www.winamp.com/">Winamp</a><BR>
icy-notice2: SHOUTcast Distributed Network Audio Server/SolarisSparc v1.9.4<BR>
icy-name: Secret Agent: The soundtrack for your stylish, mysterious, dangerous life. For Spys and P.I.'s too! [SomaFM]
icy-genre: Downtempo Lounge Spy
icy-url: http://www.somafm.com
icy-pub: 1
icy-metaint: 8192
icy-br: 128
icy-irc: #shoutcast
icy-icq: 0
icy-aim: N/A

"http://nsv.stream.aol.com/uvox?cachefile=/aol/us/aolmusic/artists/wmg/80spopculture/aha_takeonme_120.nsv"
===============================
HTTP/1.1 200 OK
Date: Fri, 17 Sep 2004 21:15:06 GMT
Server: MODS/1.0 (optimized-dpare-02)
Content-Length: 2768860
Ultravox-Max-Msg: 3080
Ultravox-Avg-Bitrate: 98588
Ultravox-Max-Bitrate: 98588
Accept-Ranges: bytes
Connection: close
Content-Type: misc/ultravox

http://64.156.25.86:8010/;stream.nsv  (last exile)
http://64.156.25.86:8000/;stream.nsv  (love hina)
===============================
ICY 200 OK
icy-notice1:<BR>This stream requires <a href="http://www.winamp.com/">Winamp</a><BR>
icy-notice2:SHOUTcast Distributed Network Audio Server/FreeBSD4 v1.9.2<BR>
icy-name:desync.com: Last Exile
icy-genre:Anime
icy-url:http://desync.com/
Content-Type:video/nsv
icy-pub:1
icy-metaint:8192
icy-br:500

http://pubint.sc.llnwd.net:10045/
===============================
ICY 200 OK
icy-notice1:<BR>This stream requires <a href="http://www.winamp.com/">Winamp</a><BR>
icy-notice2:SHOUTcast Distributed Network Audio Server/Linux v1.9.2<BR>
icy-name:KUVO Public Radio
icy-genre:
icy-url:http://www.kuvo.org
Content-Type:audio/mpeg
icy-pub:0
icy-metaint:8192
icy-br:24

"http://www.live365.com/play/294341?LID=506-usa&lid=506-usa&SaneID=132.183.12.126-1095458924342&AuthType=NORMAL&VisitCount=1&bitrate=256&now=1095458993234&pid=40564"
===============================
---------------
HTTP/1.1 302 Found
Date: Fri, 17 Sep 2004 22:11:04 GMT
Server: Apache
Location: http://216.235.81.11:20186/play?membername=&session=velvet_ant:0&LID=506-usa&lid=506-usa&AuthType=NORMAL&SaneID=132.183.12.126-1095458924342&VisitCount=1&bitrate=256&now=1095458993234&pid=40564
Content-Type: text/html; charset=iso-8859-1
Connection: close
---------------
---------------
HTTP/1.0 200 OK
Server: Nanocaster/2.5.13
Content-Type: audio/mpeg
Cache-Control: no-cache
Pragma: no-cache
Connection: close
Content-Length: 44000000
---------------

Shoutcast vs streamripper headers
=================================
ICY 200 OK
icy-notice1:<BR>This stream requires <a href="http://www.winamp.com/">Winamp</a><BR>
icy-notice2:SHOUTcast Distributed Network Audio Server/Linux v1.9.4<BR>
icy-name:[JAPANESE R&B, HIPHOP, JROCK, JPOP & NEW RELEASES] SeiyaUsagi.Net Radio wo kiite kudasai!: SeiyaUsagi.Net Radio
icy-genre:World
icy-url:http://www.seiyausagi.net
content-type:audio/mpeg
icy-pub:1
icy-metaint:8192
icy-br:32

HTTP/1.0 200 OK
Server:SHOUTcast/Linux v1.9.4
icy-name:[relay stream] [JAPANESE R&B, HIPHOP, JROCK, JPOP & NEW RELEASES] SeiyaUsagi.Net Radio wo kiite kudasai!: SeiyaUsagi.Net Radio
icy-url:http://www.seiyausagi.net
icy-br:32
icy-metaint:8192
Content-Type: audio/mpeg

* More problems

Bitrate = 0 stuff:
http://www.mperia.com:8000/content/1569.mp3


-----------------------------------------------------------------------
* New filename output stuff

Pattern specifiers you can use:

%S     Stream
%A     Artist
%T     Title
%a     Album
%D     Date and time (per song)
%d     Date and time (per execution)
%Q     Sequence number (parsing files to find it)
%q     Sequence number (starting from zero)
%0203q Sequence number (starting from 203)
%V     Song version number (?)
%%     Percent sign

The default pattern is:

%S/%A - %T

Extensions, such as ".mp3", ".aac", ".ogg", or ".nsv" are 
automatically appended.

Incomplete directory will be the most deeply nested directory 
that doesn't depend on the pattern specifiers %A, %T, %a, %D, 
%q, or %Q.  The directory may depend on %d and %S.

Thus, the default incomplete directory is:

%S/incomplete

The filename within the incomplete directory is ??

For showfile, the idea is similar, but some patterns don't apply. Thus, 
the default pattern is:

%S/sr_program_%d


HERE IS HOW THE -d and -D FLAGS INTERACT:

-d dir     -D pat        Action
--------   --------     ---------
absolute   absolute     Use: pat
relative   absolute     Use: pat
missing    absolute     Use: pat
absolute   relative     Concatinate: dir/pat
relative   relative     Concatinate: pwd/dir/pat
missing    relative     Concatinate: pwd/pat
absolute   missing      Concatinate: dir/default_pat
relative   missing      Concatinate: pwd/dir/default_pat
missing    missing      Use: pwd/default_pat

-----------------------------------------------------------------------
* How to upgrade the version number

1)  configure.ac
2)  lib/rip_manager.h
3)  winamp_plugin/sr2x.nsi
4)  makedist_win.bat
5)  streamripper.1.asc

-----------------------------------------------------------------------
* Generated files

I deleted the automatically generated files from CVS.  The people 
who download from CVS should be advanced enough to figure out 
how to build.  Just in case, I included a config.sh file to show 
how it is done.

Note the Windows mad.h should be coming from the msvc++ directory 
anyways, so there is no need to keep the version built on unix.

CVS: 	Makefile.in configure libmad/Makefile.in 
CVS: 	libmad-0.15.1b/Makefile.in libmad-0.15.1b/mad.h 
CVS: 	libmad-0.15.1b/msvc++/Makefile.in 

-----------------------------------------------------------------------
* How to build streamripper 1.70

1) pkg-config
2) gettext
3) glib

CFLAGS=-I$HOME/LOCAL-td191/include LDFLAGS=-L$HOME/LOCAL-td191/lib ./configure --prefix=$HOME/LOCAL-td191

-----------------------------------------------------------------------
* Compile farms

http://www.testdrive.hp.com	hpux, freebsd
http://powerdev.osuosl.org	linux
http://www.blastwave.org	solaris
http://freeshell.org		netbsd

For HP-UX, I'm testing on this one:
td191.testdrive.hp.com

-----------------------------------------------------------------------
* MP3 utilities
~~~~~~~~~~~~~~~
MP3TRIM
~~~~~~~
http://www.logiccell.com/~mp3trim/
(win only - did not seem to fix/detect prob)

ENCSPOT
~~~~~~~
http://www.guerillasoft.nstemp.com/EncSpot2/download.html
(win only - did not seem to fix/detect prob)

DR TAG/MP3 Repair Tool
~~~~~~~~~~~~~~~~~~~~~~
http://www.drtag.de/en/description_mp3rt.htm
(win only - did seem to fix/detect prob)

mp3_check
~~~~~~~~~
(unix command line/see freshmeat)

-----------------------------------------------------------------------
* The dependencies for version 1.54

Dump of file gen_sripper.dll

File Type: DLL

  Image has the following dependencies:

    KERNEL32.dll
    USER32.dll
    GDI32.dll
    ADVAPI32.dll
    SHELL32.dll
    WS2_32.dll
    COMCTL32.dll
    MSVCRT.dll

Dump of file consolewin32.exe

File Type: EXECUTABLE IMAGE

  Image has the following dependencies:

    KERNEL32.dll
    WS2_32.dll

* The dependencies for version 1.60 plugin, 1.60.5 console

Dump of file gen_sripper.dll

File Type: DLL

  Image has the following dependencies:

    WS2_32.dll
    COMCTL32.dll
    KERNEL32.dll
    USER32.dll
    GDI32.dll
    ADVAPI32.dll
    SHELL32.dll
    MSVCR70.dll

Dump of file sripper-1.60.5.exe

File Type: EXECUTABLE IMAGE

  Image has the following dependencies:

    KERNEL32.dll
    WS2_32.dll

* As of 1.61.1, I'm switching to MSVCRT.DLL linking (-MD)


-----------------------------------------------------------------------
How to tag a new version (e.g. for version 1.60)

  cvs rtag -r HEAD sripper-1_60 sripper_1x

-----------------------------------------------------------------------
How to revise libmad

First, match the auto* versions used by libmad.  For libmad-0.15.1b, 
this is :

  - autoconf 2.59, automake 1.8.2, libtool 1.5.2.

Next in libmad/Makefile.am, make the following modifications.

  ## GCS - don't install for streamripper
  ## lib_LTLIBRARIES =	libmad.la
  noinst_LTLIBRARIES = libmad.la

  ## GCS - don't install for streamripper
  ## include_HEADERS =	mad.h
  noinst_HEADERS = mad.h

In Makefile.am & configure.ac, comment out the msvc++ stuff.  No need 
to build makefiles, nor to distribute.

Next rebuild the auto* files.  Test it all out and make sure it works.

Finally, in the top level Makefile.am, replace the define for 
libmad_manifest with the latest list of original files from the 
libmad distro.

-----------------------------------------------------------------------
How to revise libtre

Check to make sure my versions work.  Here is what I use for tre-0.7.0:

  - autoconf 2.59, automake 1.8.2, libtool 1.5.2.

Next, in libtre/configure.ac, comment out the disable static line:

dnl AM_DISABLE_STATIC

Next rebuild the auto* files.  Test it all out and make sure it works.

Edit these files in sripper_1x to change the directory location:
    config.sh
    Makefile.am
    configure.ac

To be finished:

a) which files to remove from cvs?  (e.g. configure)
b) get rid of installation from Makefile.am's
c) add manifest to distro

Note Apr 15, 2007:
  - autoconf 2.60, automake 1.9.6, libtool 1.5.22.

Note Sep 1, 2007
Found that make install failed for libtre
Add to configure.ac: 
  AC_PROG_MKDIR_P
Add po/Makefile.in.in:
  datarootdir = @datarootdir@
  MKINSTALLDIRS = @MKDIR_P@
  mkinstalldirs = @MKDIR_P@
Still need to figure out how to disable "make install" for tre, 
since we don't actually need to install it.

-----------------------------------------------------------------------
MinGW problems

Seems that 1.0.11 doesn't play well with windows 98.  

1.0.11-2004.04.03
-----------------
1) Rxvt fails when run from the batch file, though it works 
   from the command line.

snapshot
--------
1) The snapshot has a .bat file with unix EOL
2) Rxvt fails (flashes then closes) from either batch file or 
   command line.
3) sh fails.  For example:

C:\msys\1.0>bin\sh
SH-2.04$ ls
 - Cannot openSH-2.04$
SH-2.04$


There are good doc on installing msys here:

http://www.swig.org/Doc1.3/Windows.html
http://mldonkey.sourceforge.net/Windows

-----------------------------------------------------------------------
How to compile cdk

* Using binary distro of pdcurses, and compile under MSYS/MinGW.
  Use full path for CFLAGS/LDFLAGS, or else examples don't build.

1) CFLAGS=-I/d/sripper_1x/pdcurses-win32-3.2 LDFLAGS=-L/d/sripper_1x/pdcurses-win32-3.2 ./configure

* Additional changes after patch sent to Tim Dickey

1) Guards in cdk.h
#ifdef HAVE_UNISTD_H
#include <unistd.h>
#endif
#ifdef HAVE_DIRENT_H
#include <dirent.h>
#endif


Old notes:

1) Copy curses header files to /mingw/include, and libraries to 
   /mingw/lib.
2) Be sure to rename pdcurses.lib to curses.lib (but don't rename 
   the dll).
3) Configure the cdk package.
4) Comment out <pwd.h> and <grp.h> in include/cdk.h
5) Edit these files, and workaround missing defines and functions
     include/cdk.h
     fselect.c
6) Build
7) Comment out <cdk_config.h> in cdk.h
8) Comment out <unistd.h>, <dirent.h> in cdk.h
9) Comment out mode2Filetype, mode2Char, Beep in cdk_util.h
10) Commentout DELETE in curdefs.h
11) Commentout boolean in cdk.h

RMK: Can't comment out boolean, because it is required by fn protos


-----------------------------------------------------------------------
For n seconds, we need buffersize of b bytes:
	b = bitrate * 1000 * n

*** Default splitting


	    /mi
	    |           /ts
	    |-----------|
	      xs_offset |
			|
			|
	      |---------|---------|
		prepad    postpad


*** Silence splitting

	    /mi
	    |  
	    |-----------|
	      xs_offset |
			|
		    ts\ |
	      |-------+-|---------|
	       pre_sw |   post_sw
		      |
		  |---+---| *silence_win
		      |
	|-------------|---------|
	      prepad    postpad



-----------------------------------------------------------------------
Computing bps

http://www.hydrogenaudio.org/index.php?showtopic=12633&
--
(1) The equation:
bitrate[kbps] = space[kbits] / time[seconds]

(2) unit conversions:
time[seconds] = time[minutes] * 60
space[bits] = space[bytes] * 8
space[K] = space[M] * 1024

(3)The equation for other units - (1) and (2) combined:
bitrate[kbps] = 8*1024/60 * space[MB] / time[minutes] = 136.53 * space[MB] / time[minutes]
bitrate[kbps] = 8*1024 * space[MB] / time[seconds] = 8192 * space[MB] / time[seconds]

That's the nice theory, but I'm not sure about two practical details:
-is the Kilo/Mega conversion correct for MP3 bitrates? or is the factor 1000 instead of 1024? does anybody else know that?
-there may be some overhead related to the actual storing of the files, so you might want to do your calculations with some "headroom". for instance, add a minute or two to the real time. this gives you a slightly lower bitrate (smaller files). just test it for yourself to see how much the "ideal" factor has to be adjusted.

HDD space:
1 MB = 1024 KB
1 KB = 1024 Bytes

Bitrate:
1 kbps = 1000 bits/sec.

=>
bitrate[kbps] = 8*1024*1024/(60*1000) * space[MB] / time[minutes] = 139.8 * space[MB] / time[minutes]
bitrate[kbps] = 8*1024*1024/1000 * space[MB] / time[seconds] = 8388 * space[MB] / time[seconds]

--
Also see,
http://www.unrelatedinventions.com/Audiotools/Help/thejargonbehindmp3.htm

-----------------------------------------------------------------------
What are some locales?  

Here is what my win2k box says...

STREAMRIPPER windows 1.62-beta-2
LOCALE is English_United States.1252
Using locale_charset() to get system codeset.
SystemDefaultLCID: 0411
UserDefaultLCID: 0409
Have iconv.
Locale codeset: CP932
Filesys codeset: CP932
ID3 codeset: CP932
Metadata codeset: CP932
Relay codeset: CP932

Here is what my win98 box says...

STREAMRIPPER windows 1.62-beta-2
LOCALE is English_United States.1252
Using locale_charset() to get system codeset.
SystemDefaultLCID: 0409
UserDefaultLCID: 0409
Have iconv.
Locale codeset: CP1252
Filesys codeset: CP1252
ID3 codeset: CP1252
Metadata codeset: CP1252
Relay codeset: CP1252

CP932 is shift-jis
CP1252 is a superset of ISO-8859-1

-----------------------------------------------------------------------
How to create a sjis locale

localedef -v -c -i ja_JP -f SHIFT_JIS ja_JP.SJIS
localedef -v -c -i ja_JP -f EUC-JP ja_JP.EUC-JP

Here is how to display

export LANG=ja_JP.SJIS
## The following no longer works.  Why?
## xterm -fn -misc-fixed-medium-r-semicondensed--13-120-75-75-c-60-iso10646-1
xterm

bash-3.00$ export LANG=ja_JP.EUC-JP
bash-3.00$ xterm
bash-3.00$ export LANG=ja_JP.SJIS
bash-3.00$ xterm
bash-3.00$ export LANG=ja_JP.UTF-8
bash-3.00$ xterm

-----------------------------------------------------------------------
How do strings pass through the program?

ripstream_rip_mp3
  get_stream_data --> fill in m_current_track.raw_metadata
  parse_metadata  --> fill in m_current_track.artist,title,album


-----------------------------------------------------------------------
For Windows

Unicows:
http://www.microsoft.com/downloads/details.aspx?FamilyID=73ba7bd7-ed06-4f0d-80a4-2a7eeaee17e2&DisplayLang=en
http://www.microsoft.com/globaldev/handson/dev/mslu_announce.mspx

-----------------------------------------------------------------------
For Mac OSX 10.3

1) Use wopen with utf8 (?)

-----------------------------------------------------------------------
How to build libiconv on windows

STEP 1: Make changes to config.h.msvc

#define      EILSEQ          42
#undef ENABLE_RELOCATABLE
#define ICONV_CONST const
#define HAVE_WCHAR_H 1
#define HAVE_WCHAR_T 1


STEP 2: Build dll's

copy /y config.h.msvc config.h
copy /y config.h libcharset
copy /y config.h lib

erase lib\*.obj
erase srclib\*.obj
erase libcharset\lib\*.obj

//nmake -f Makefile.msvc NO_NLS=1 DLL=1 MFLAGS=-MD
nmake -f Makefile.msvc NO_NLS=1 MFLAGS=-MD

step 3: gather files

mkdir iconv-win32-1.11
copy /y libcharset\include\localcharset.h iconv-win32-1.11
copy /y include\iconv.h iconv-win32-1.11

move /y lib\iconv.lib iconv-win32-1.11
move /y libcharset\lib\charset.lib iconv-win32-1.11


-----------------------------------------------------------------------
A possible macro for detecting locale_charset()

I'm going to call mine "HAVE_LOCALE_CHARSET"

AC_DEFUN(AC_FIND_LOCALE_CHARSET,
[
have_locale_charset='no'
have_localcharset_h='no'
AC_CHECK_HEADER(localcharset.h,have_localcharset_h='yes',have_localcharset_h='no')
if test "$have_localcharset_h" = 'yes'; then
  have_libcharset='no'
  AC_CHECK_LIB(charset,locale_charset,have_libcharset='yes',have_libcharset='no')
  if test "$have_libcharset" = 'yes'; then
    LIBCHARSET="-lcharset"
    AC_SUBST(LIBCHARSET)
    AC_DEFINE(HAVE_LIBCHARSET,,Define if you have libcharset)
    have_locale_charset='yes'
  fi
fi

AC_CHECK_HEADER(langinfo.h,have_langinfo_h='yes',have_langinfo_h='no')
if test "$have_langinfo_h" = 'yes'; then
    AC_DEFINE(HAVE_LANGINFO_H,,Define if you have langinfo.h)
fi
])

-----------------------------------------------------------------------
Other MP3 libraries

mpglib
xaudio_sdk

-----------------------------------------------------------------------
Clients (windows)
winamp 5
foobar2000
windows media player
media player classic
itunes player
sonique (sonique.lycos.com)

Clients (unix)
xmms w/ and w/o metadata
mpg123
mpg321
ogg123
bmp, bmpx (http://bmp.beep-media-player.org)
lamip (http://fondriest.frederic.free.fr/realisations/lamip/index.html)
RhythmBox (gnome)
Amarok (KDE)
Juk (KDE)
Zinf
Audacious (http://audacious-media-player.org)
wget -O - http://stream:8000 | madplay -
Quod Libet (http://www.sacredchao.net/quodlibet/wiki/Download)

Mostly things work, except mpg321 which seems to glitch even
if I am connecting directly to the stream (i.e. without
using streamripper).

-----------------------------------------------------------------------
Other OS's

http://www.yellowtab.com/products/   (commercial BeOS)
http://www.haiku-os.org/             (free, BeOS-compatible)
http://www.syllable.org/
http://l4hq.org/

-----------------------------------------------------------------------
Bootleg sites

Torrent/web sites:
www.archive.org
bt.etree.org
purelivegigs.com
http://www.thetradersden.org/
www.filesoup.com
http://www.dimeadozen.org/
http://www.bootcity.org
http://www.shnflac.net/
http://www.pinkrobert.net
http://oink.cd
tc

Band specific sites:
trading.countingcrows.com (Counting crows, B&P)
antsmarching.org (Dave Matthews)
http://royal-orleans.com/ (Led Zeppelin)
http://www.rustradio.org (Neil Young)
http://digitalpanic.org (Widespred Panic)
http://redcorvertte.free.fr/livemusic.htm (Prince)
http://pj.sidewalkcrusaders.com/ (Perl Jam)
http://tracker.hipfans.com/ (Tragically Hip)
http://www.gdlive.com/ (Grateful Dead, others)
http://u2torrents.com/ (U2)

Links to BT sites:
Smiler's links (http://smiler.no-ip.org/BT/BTlinks.php
http://launch.groups.yahoo.com/group/bt-dimeadozen-org/links
http://scottgill.com/ (d/l sites)

Downloads
http://www.nyctaper.com
http://tela.sugarmegs.org/

-----------------------------------------------------------------------
Misc music:
Jamendo, Magnatune

-----------------------------------------------------------------------
Shoutcast lists

shoutcast.com (mp3)
icecast.org (mp3/ogg)
oddsock.org
http://www.steamcast.com/
jetcast/jetaudio (mp3)
peercast (relay-to-shoutcast)
www.tuner2.com (aac)
live365

mostly non-shoutcast
http://www.radio-locator.com/cgi-bin/home
http://www.wwitv.com/portal.htm?http://www.wwitv.com/television/index.html

A couple of korean ones
inlive.co.kr (?)
http://www.mukulcast.com/ (?)

A japanese one
http://live.ladio.livedoor.com/


-----------------------------------------------------------------------
Improving winamp plugin.  Implement some combination of these.

Type A
a) Use "send to:" to get URL without playing first
b) Like send to, but with keystroke or top level menu
c) Auto detect selection

Type B
a) Intercept double click, enter, dragndrop, etc
b) Get a callback before start of play

Type C
a) Internal caching of recent streams (not releated to winamp)

-----------------------------------------------------------------------
AAC goop. Ugh (:P), but here we go...


Definitions
===========
mpeg-4		Complementary to mpeg-2. Aac may be used with mpeg-2 or mpeg-4.

		Mpeg-4 is patented, and it is hard to know who owns 
		the patents.  AT&T is suing Apple over this.
		Apparently, mpeg-4 is an extension of the quicktime format.

aac		This would be mpeg-2 part 7 or mpeg-4 part 3.

		No patents are required for aac decoding, but encoding 
		may require licenses.

aac-lc		Low complexity, one of four default "profiles" or algorithms.
		This exists in mpeg-2 or mpeg-4.

he-aac		(aacPlus v1 or aac+) High efficiency. This is an extension.
		It is a combination of SBR (Spectral Band Replication) 
		and AAC.  This exists only in mpeg-4.

		This also seems to be proprietary.
		 http://www.codingtechnologies.com

he-aac v2	(aacPlus v2) Combines parametric stereo and HE-AAC.

		This also seems to be proprietary.
		 http://www.codingtechnologies.com

An interesting web page
=======================
http://wiki.multimedia.cx/index.php?title=Understanding_AAC

Software
========
FAAD2		The last GPL-compatible version is apparently 2005-01-30.
	http://www.rarewares.org/rja/faad2-2005-01-30.rar
	http://www.hydrogenaudio.org/forums/lofiversion/index.php/t35535.html

FAAD		Any reason to use this over the GPL-compatible version 
		of FAAD2

FAAD2 forks	Useful? Xine-lib, mplayer, others?

MPEG4IP		Useful?
	http://mpeg4ip.sourceforge.net

Building mpeg4ip
================
bash-3.00$ ./bootstrap 
dir: .
SDL appears to be installed
Error - we have detected a version of faac that has libmp4v2 support
and no copy of mpeg4ip-config.  This means faac was built with
faad2 and the libraries will be incompatible.
Please reinstall faac without mp4v2 support
bash-3.00$   

So I rebuilt faac as follows:

 ./configure --prefix=/usr --without-mp4v2

Again rebuilding


Building faad
=============
To build faad2-2.5, do this:
 tar xf faad2-2.5.tar.gz &&
 cd faad2 &&
 echo > plugins/Makefile.am &&
 echo > plugins/xmms/src/Makefile.am &&
 sed -i '/E_B/d' configure.in &&
 autoreconf -vif &&
 ./configure --prefix=/usr &&
make

Faad can depend on mpeg4ip
Try building like this:

 ./configure --with-mpeg4ip

Next, I switched back to the GPL version for development purposes. 
I rebuilt it like this:

 ./configure --with-mp4v2

When you run checkinstall, you gotta do this:

  checkinstall --pkgname=faad2 --pkgversion=2005-01-30


Dependency chart (?)
====================
Here, "->" meand "depends on

libavcodec (ffmpeg) -> faad
libavcodec (ffmpeg) -> faac
faad -> mpeg4ip
mpeg4ip -> faac,lame,x264
mpeg4ip -> ffmpeg (??)

Nero AAC
========
There are two tricks to getting the neroAacEnc to run.

First, the input shouldn't be something like 16000Hz mono, which causes 
the program to choke.  Standard 44100Hz stereo does seem to work.

Second, it doesn't like it if you run (under wine) from a normal 
directory.  You have to put it in ~/.wine/drive_c/windows/temp or such.

